{"version":3,"file":"tagselector.js","sources":["../src/tagselector.js","../src/index.js"],"sourcesContent":["/*!\n * TagSelector\n * \n * @author Ryan Fitzgerald\n * @version 0.2.1\n * @license MIT\n * \n * Repo: https://github.com/RyanFitzgerald/tagselector\n * Issues: https://github.com/RyanFitzgerald/tagselector/issues\n */ \nconst defaults = {\n  max: false,\n  onInit: false,\n  onDestroy: false,\n  onSelect: false,\n  onDeselect: false\n};\n\nconst getSettings = userSettings => {\n  const updated = {};\n  Object.keys(defaults).forEach(key => {\n    if (userSettings[key]) {\n      updated[key] = userSettings[key];\n    } else {\n      updated[key] = defaults[key];\n    }\n  });\n  return updated;\n};\n\nconst getOptions = ele => {\n  const optionList = ele.options;\n  const optionObj = {};\n\n  for (let i = 0; i < optionList.length; i++) {\n    optionObj[optionList[i].value] = {\n      'text': optionList[i].text,\n      'index': i,\n      'selected': optionList[i].selected\n    };\n  }\n\n  return optionObj;\n};\n\nconst insertAfter = (ele, ref) => {\n  ref.parentNode.insertBefore(ele, ref.nextSibling);\n};\n\nclass TagSelector {\n  constructor(ele, userSettings) {\n    // Create required properties\n    this.ele = ele;\n    this.userSettings = userSettings || {};\n    this.isMultiple = this.ele.multiple;\n    this.selected = [];\n    this.options = {};\n    this.settings = {};\n    this.wrapper = null;\n\n    // Ensure ele was a valid select field\n    if (!this.ele || this.ele === null || this.ele.tagName !== 'SELECT') {\n      console.error('Error: Must provide a valid ID for select field');\n      return;\n    }\n\n    // Initialize\n    this.init();\n  }\n\n  init() {\n    // Get options and settings\n    this.options = getOptions(this.ele);\n    this.settings = getSettings(this.userSettings);\n\n    // Hide select\n    this.ele.style.display = 'none';\n\n    // Create wrapper element\n    this.wrapper = document.createElement('div');\n    this.wrapper.className = 'tagselector-wrapper';\n    insertAfter(this.wrapper, this.ele);\n\n    // Add tags within wrapper\n    Object.keys(this.options).forEach((key, i) => {\n      // Create tag with necessary properties\n      const tag = document.createElement('span');\n      tag.className = 'tagselector-tag';\n      tag.innerHTML = this.options[key].text;\n      tag.dataset.tagvalue = key;\n      tag.dataset.tagindex = this.options[key].index;\n\n      // Add active class if selected\n      if (this.options[key].selected) {\n        tag.classList.add('active');\n        this.selected.push(key);\n      }\n\n      // Add listener\n      this.addTagListener(tag);\n\n      // Add tag to wrapper\n      this.wrapper.appendChild(tag);\n    });\n\n    // Call init function if provided\n    if (this.settings.onInit && typeof(this.settings.onInit) === 'function') {\n      this.settings.onInit();\n    }\n  }\n\n  addTagListener(tag) {\n    // Save copies of needed properties\n    const selected = this.selected;\n    const ele = this.ele;\n    const wrapper = this.wrapper;\n    const isMultiple = this.isMultiple;\n    const settings = this.settings;\n    const options = this.options;\n\n    tag.addEventListener('click', function() {\n      const value = this.dataset.tagvalue;\n      const index = this.dataset.tagindex;\n\n      if (this.classList.contains('active')) {\n        // Do nothing if regular select\n        if (!isMultiple) {\n          return;\n        }\n\n        // Remove active class\n        this.classList.remove('active');\n\n        // Remove key from selected array\n        const keyIndex = selected.findIndex(x => x.value === value && x.index === index);\n        if (keyIndex > -1) {\n          selected.splice(keyIndex, 1);\n        }\n\n        // Deselect it\n        ele.options[index].selected = false;\n\n        // Call deselect function if provided\n        if (settings.onDeselect && typeof(settings.onDeselect) === 'function') {\n          settings.onDeselect(value, options[value].text);\n        }\n      } else {        \n        // Handle based on type of select\n        if (isMultiple) {\n          // Push to selected array\n          selected.push({value, index});\n\n          // Check if greater than max\n          if (settings.max && selected.length > settings.max) {\n            // Get index to remove\n            const removeValue = selected[0].value;\n            const removeIndex = options[removeValue].index;\n\n            // Deselect it\n            ele.options[removeIndex].selected = false;\n\n            // Remove active class from first element\n            wrapper.querySelector(`.tagselector-tag.active[data-tagvalue=\"${removeValue}\"]`).classList.remove('active');\n\n            // Call deselect function if provided\n            if (settings.onDeselect && typeof(settings.onDeselect) === 'function') {\n              settings.onDeselect(selected[0].value, options[selected[0].value].text);\n            }\n\n            // Pop first member of array\n            selected.shift();\n          }\n        } else {\n          // Remove all active classes\n          wrapper.querySelector('.tagselector-tag.active').classList.remove('active');\n        }\n\n        // Select it\n        ele.options[index].selected = true;\n\n        // Call select function if provided\n        if (settings.onSelect && typeof(settings.onSelect) === 'function') {\n          settings.onSelect(value, options[value].text);\n        }\n\n        // Add active class\n        this.classList.add('active');\n      }\n    });\n  }\n\n  destroy() {\n    // Clear properties\n    this.selected = [];\n    this.options = {};\n\n    // Delete wrapper\n    this.wrapper.parentNode.removeChild(this.wrapper);\n    this.wrapper = null;\n\n    // Show ele and delete reference\n    this.ele.style.display = 'initial';\n\n    // Call destroy function if provided\n    if (this.settings.onDestroy && typeof(this.settings.onDestroy) === 'function') {\n      this.settings.onDestroy();\n    }\n\n    // Delete settings\n    this.settings = {};\n  }\n\n  reload() {\n    // Clear properties\n    this.selected = [];\n    this.options = {};\n\n    // Delete wrapper\n    this.wrapper.parentNode.removeChild(this.wrapper);\n    this.wrapper = null;\n\n    // Call init\n    this.init();\n  }\n}\n\n// module.exports = TagSelector;\n\n// At the end of your tagselector.js file\nexport default TagSelector; // Use this line to export the class","// Import the TagSelector JavaScript module\nimport TagSelector from './tagselector';\n\n// Import the corresponding SCSS file\nimport './tagselector.scss';\n\n// Import additional styles here\n// import './custom.css'; // If you have custom styles\n\n// Your custom JavaScript code can go here\nconsole.log('TagSelector is ready!');\n\n// Export the TagSelector for use in other modules\nexport default TagSelector;\n"],"names":["defaults","max","onInit","onDestroy","onSelect","onDeselect","TagSelector","ele","userSettings","_classCallCheck","this","isMultiple","multiple","selected","options","settings","wrapper","tagName","init","console","error","key","value","updated","ref","_this","optionList","optionObj","i","length","text","index","getOptions","Object","keys","forEach","style","display","document","createElement","className","parentNode","insertBefore","nextSibling","tag","innerHTML","dataset","tagvalue","tagindex","classList","add","push","addTagListener","appendChild","addEventListener","contains","remove","keyIndex","findIndex","x","splice","removeValue","removeIndex","querySelector","concat","shift","removeChild","log"],"mappings":"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"}